#!/usr/bin/python
#
# Copyright (C) 2015  Custodia Project Contributors - see LICENSE file

import sys
import os
from custodia.http.server import LocalHTTPServer
from custodia.root import Root


cfgfile = None
if (len(sys.argv) > 1):
    cfgfile = sys.argv[-1]
elif os.path.isfile('custodia.conf'):
    cfgfile = 'custodia.conf'
elif os.path.isfile('/etc/custodia/custodia.conf'):
    cfgfile = '/etc/custodia/custodia.conf'
else:
    raise IOError("Configuration file not found")


if __name__ == '__main__':
    address = os.path.join(os.getcwd(), 'server_socket')
    config = {'server_string': 'Secret/0.0.7',
              'consumers': {'/': Root()}}
    httpd = LocalHTTPServer(address, config)
    print httpd.get_socket()
    httpd.serve()
